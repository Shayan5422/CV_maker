<!-- resume-form.component.html -->
<div class="min-h-screen bg-gray-100 py-8">
    <div class="max-w-5xl mx-auto px-4">
      <!-- Main Form Card -->
      <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
        <!-- Header -->
        <div class="flex items-center gap-3 mb-8 border-b pb-4">
          <i class="fas fa-file-alt text-2xl text-blue-600"></i>
          <h1 class="text-2xl font-semibold text-gray-800">
            {{ isEditing ? 'Edit Resume' : 'Create New Resume' }}
          </h1>
        </div>
  
        <!-- Form -->
        <form [formGroup]="resumeForm" (ngSubmit)="onSubmit()" class="space-y-8">
          <!-- Basic Information -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center gap-2 border-b pb-4">
              <i class="fas fa-user text-lg text-blue-600"></i>
              <h2 class="text-xl font-medium">Basic Information</h2>
            </div>
  
            <!-- Resume Title -->
            <div class="form-group">
              <label class="block text-sm font-medium text-gray-700 mb-2">Resume Title</label>
              <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-heading text-gray-400"></i>
                </div>
                <input
                  type="text"
                  formControlName="title"
                  class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  [ngClass]="{'border-red-500': submitted && f['title'].errors}"
                  placeholder="e.g. Senior Developer Resume"
                >
                <div *ngIf="submitted && f['title'].errors" class="mt-1 text-sm text-red-600">
                  <span *ngIf="f['title'].errors['required']">Title is required</span>
                </div>
              </div>
            </div>
  
            <!-- Name -->
            <div class="form-group">
              <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
              <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-user text-gray-400"></i>
                </div>
                <input
                  type="text"
                  formControlName="full_name"
                  class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  [ngClass]="{'border-red-500': submitted && f['full_name'].errors}"
                >
                <div *ngIf="submitted && f['full_name'].errors" class="mt-1 text-sm text-red-600">
                  <span *ngIf="f['full_name'].errors['required']">Full name is required</span>
                </div>
              </div>
            </div>
  
            <!-- Contact Row -->
            <div class="grid md:grid-cols-2 gap-6">
              <!-- Email -->
              <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                <div class="relative rounded-md shadow-sm">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-envelope text-gray-400"></i>
                  </div>
                  <input
                    type="email"
                    formControlName="email"
                    class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    [ngClass]="{'border-red-500': submitted && f['email'].errors}"
                  >
                  <div *ngIf="submitted && f['email'].errors" class="mt-1 text-sm text-red-600">
                    <span *ngIf="f['email'].errors['required']">Email is required</span>
                    <span *ngIf="f['email'].errors['email']">Invalid email format</span>
                  </div>
                </div>
              </div>
  
              <!-- Phone -->
              <div class="form-group">
                <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                <div class="relative rounded-md shadow-sm">
                  <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-phone text-gray-400"></i>
                  </div>
                  <input
                    type="tel"
                    formControlName="phone"
                    class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    [ngClass]="{'border-red-500': submitted && f['phone'].errors}"
                  >
                </div>
              </div>
            </div>

            <!-- Location Row -->
            <div class="form-group">
              <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
              <div class="relative rounded-md shadow-sm">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-map-marker-alt text-gray-400"></i>
                </div>
                <input
                  type="text"
                  formControlName="city"
                  class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                  [ngClass]="{'border-red-500': submitted && f['city'].errors}"
                >
                <div *ngIf="submitted && f['city'].errors" class="mt-1 text-sm text-red-600">
                  <span *ngIf="f['city'].errors['required']">City is required</span>
                </div>
              </div>
            </div>

            <!-- Languages Section -->
            <section class="space-y-6 bg-gray-50 rounded-lg p-6">
              <div class="flex items-center justify-between border-b pb-4">
                <div class="flex items-center gap-4">
                  <i class="fas fa-language text-lg text-blue-600"></i>
                  <h2 class="text-xl font-medium" *ngIf="!isEditingLanguagesTitle">{{ f['languages_title'].value || 'LANGUAGES' }}</h2>
                  <input type="text"
                         *ngIf="isEditingLanguagesTitle"
                         formControlName="languages_title"
                         class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                         (blur)="toggleTitleEdit('languages')"
                         (keyup.enter)="toggleTitleEdit('languages')"
                         [value]="f['languages_title'].value">
                  <button type="button" 
                          (click)="toggleTitleEdit('languages')"
                          class="text-gray-400 hover:text-blue-600 ml-2">
                    <i class="fas" [class.fa-edit]="!isEditingLanguagesTitle" [class.fa-check]="isEditingLanguagesTitle"></i>
                  </button>
                </div>
                <button type="button" 
                        (click)="addLanguage()" 
                        class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                  <i class="fas fa-plus"></i>
                  Add Language
                </button>
              </div>

              <div formArrayName="languages">
                <div *ngFor="let lang of languagesArray.controls; let i = index"
                     [formGroupName]="i"
                     class="bg-white rounded-lg shadow-sm p-6 relative">
                  <!-- Remove Button -->
                  <button type="button"
                          (click)="removeLanguage(i)"
                          class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                    <i class="fas fa-trash-alt"></i>
                  </button>

                  <!-- Language Form Fields -->
                  <div class="grid md:grid-cols-2 gap-6">
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Language</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-language text-gray-400"></i>
                        </div>
                        <input type="text"
                               formControlName="language"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>

                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Proficiency Level</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-chart-bar text-gray-400"></i>
                        </div>
                        <select
                          formControlName="proficiency"
                          class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                          [ngClass]="{'border-red-500': submitted && lang.get('proficiency')?.errors}"
                        >
                          <option value="">Select proficiency level</option>
                          <option value="Elementary">Elementary (A1)</option>
                          <option value="Basic">Basic (A2)</option>
                          <option value="Intermediate">Intermediate (B1)</option>
                          <option value="Upper Intermediate">Upper Intermediate (B2)</option>
                          <option value="Advanced">Advanced (C1)</option>
                          <option value="Mastery">Mastery (C2)</option>
                          <option value="Native">Native</option>
                        </select>
                        <div *ngIf="submitted && lang.get('proficiency')?.errors" class="mt-1 text-sm text-red-600">
                          <span *ngIf="lang.get('proficiency')?.errors?.['required']">Proficiency level is required</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <!-- Photo Upload -->
            <div class="mb-4">
              <label class="block text-gray-700 text-sm font-bold mb-2">
                Profile Photo
              </label>
              <div class="flex items-center space-x-4">
                <!-- Display existing photo if available -->
                <img *ngIf="existingPhoto" 
                     [src]="existingPhoto" 
                     class="w-32 h-32 object-cover rounded-full"
                     alt="Profile photo">
                
                <input type="file" 
                       (change)="onFileChange($event)"
                       accept="image/*"
                       class="block w-full text-sm text-gray-500
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-blue-50 file:text-blue-700
                              hover:file:bg-blue-100">
              </div>
            </div>
  
            <!-- Summary -->
            <div class="form-group">
              <label class="block text-sm font-medium text-gray-700 mb-2">Professional Summary</label>
              <textarea
                rows="4"
                formControlName="summary"
                class="block w-full px-4 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                [ngClass]="{'border-red-500': submitted && f['summary'].errors}"
              ></textarea>
            </div>
          </section>
  
          <!-- Experience Section -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center justify-between border-b pb-4">
              <div class="flex items-center gap-4">
                <i class="fas fa-briefcase text-lg text-blue-600"></i>
                <h2 class="text-xl font-medium" *ngIf="!isEditingExperienceTitle">{{ f['experience_title'].value || 'EXPERIENCE' }}</h2>
                <input type="text"
                       *ngIf="isEditingExperienceTitle"
                       formControlName="experience_title"
                       class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                       (blur)="toggleTitleEdit('experience')"
                       (keyup.enter)="toggleTitleEdit('experience')"
                       [value]="f['experience_title'].value">
                <button type="button" 
                        (click)="toggleTitleEdit('experience')"
                        class="text-gray-400 hover:text-blue-600 ml-2">
                  <i class="fas" [class.fa-edit]="!isEditingExperienceTitle" [class.fa-check]="isEditingExperienceTitle"></i>
                </button>
              </div>
              <button type="button" 
                      (click)="addExperience()" 
                      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                <i class="fas fa-plus"></i>
                Add Experience
              </button>
            </div>
  
            <div formArrayName="experience">
              <div *ngFor="let exp of experienceArray.controls; let i = index" 
                   [formGroupName]="i" 
                   class="bg-white rounded-lg shadow-sm p-6 relative">
                <!-- Remove Button -->
                <button type="button" 
                        (click)="removeExperience(i)"
                        class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                  <i class="fas fa-trash-alt"></i>
                </button>
  
                <!-- Experience Form Fields -->
                <div class="grid gap-6">
                  <div class="grid md:grid-cols-2 gap-6">
                    <!-- Company -->
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Company</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-building text-gray-400"></i>
                        </div>
                        <input type="text" 
                               formControlName="company"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                               [ngClass]="{'border-red-500': submitted && exp.get('company')?.errors}">
                      </div>
                    </div>
  
                    <!-- Position -->
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Position</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-id-badge text-gray-400"></i>
                        </div>
                        <input type="text" 
                               formControlName="position"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                               [ngClass]="{'border-red-500': submitted && exp.get('position')?.errors}">
                      </div>
                    </div>
                  </div>
  
                  <!-- Experience Dates -->
                  <div class="grid md:grid-cols-2 gap-6">
                    <!-- Start Date -->
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-calendar text-gray-400"></i>
                        </div>
                        <input type="date" 
                               formControlName="start_date"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
  
                    <!-- End Date -->
                    <div class="form-group">
                      <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium text-gray-700">End Date</label>
                        <div class="flex items-center">
                          <input type="checkbox"
                                 [formControlName]="'is_current'"
                                 class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                 (change)="exp.get('end_date')?.setValue('')">
                          <span class="ml-2 text-sm text-gray-600">Currently Working</span>
                        </div>
                      </div>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-calendar text-gray-400"></i>
                        </div>
                        <input type="date" 
                               formControlName="end_date"
                               [required]="!exp.get('is_current')?.value"
                               [attr.disabled]="exp.get('is_current')?.value"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                               [ngClass]="{'bg-gray-100': exp.get('is_current')?.value}">
                      </div>
                    </div>
                  </div>
  
                  <!-- Description -->
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea formControlName="description"
                              rows="3"
                              class="block w-full px-4 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </textarea>
                  </div>
                </div>
              </div>
            </div>
          </section>
  
          <!-- Education Section -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center justify-between border-b pb-4">
              <div class="flex items-center gap-4">
                <i class="fas fa-graduation-cap text-lg text-blue-600"></i>
                <h2 class="text-xl font-medium" *ngIf="!isEditingEducationTitle">{{ f['education_title'].value || 'EDUCATION' }}</h2>
                <input type="text"
                       *ngIf="isEditingEducationTitle"
                       formControlName="education_title"
                       class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                       (blur)="toggleTitleEdit('education')"
                       (keyup.enter)="toggleTitleEdit('education')"
                       [value]="f['education_title'].value">
                <button type="button" 
                        (click)="toggleTitleEdit('education')"
                        class="text-gray-400 hover:text-blue-600 ml-2">
                  <i class="fas" [class.fa-edit]="!isEditingEducationTitle" [class.fa-check]="isEditingEducationTitle"></i>
                </button>
              </div>
              <button type="button" 
                      (click)="addEducation()"
                      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                <i class="fas fa-plus"></i>
                Add Education
              </button>
            </div>
  
            <div formArrayName="education">
              <div *ngFor="let edu of educationArray.controls; let i = index"
                   [formGroupName]="i"
                   class="bg-white rounded-lg shadow-sm p-6 relative">
                <!-- Remove Button -->
                <button type="button"
                        (click)="removeEducation(i)"
                        class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                  <i class="fas fa-trash-alt"></i>
                </button>
  
                <!-- Education Form Fields -->
                <div class="grid gap-6">
                  <!-- Institution & Degree -->
                  <div class="grid md:grid-cols-2 gap-6">
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Institution</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-university text-gray-400"></i>
                        </div>
                        <input type="text"
                               formControlName="institution"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
  
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Degree</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-scroll text-gray-400"></i>
                        </div>
                        <input type="text"
                               formControlName="degree"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
                  </div>
  
                  <!-- Education Dates -->
                  <div class="grid md:grid-cols-2 gap-6">
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Start Date</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-calendar text-gray-400"></i>
                        </div>
                        <input type="date"
                               formControlName="start_date"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
  
                    <div class="form-group">
                      <div class="flex items-center justify-between mb-2">
                        <label class="block text-sm font-medium text-gray-700">End Date</label>
                        <div class="flex items-center">
                          <input type="checkbox"
                                 [formControlName]="'is_current'"
                                 class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                 (change)="edu.get('end_date')?.setValue('')">
                          <span class="ml-2 text-sm text-gray-600">Currently Studying</span>
                        </div>
                      </div>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-calendar text-gray-400"></i>
                        </div>
                        <input type="date"
                               formControlName="end_date"
                               [required]="!edu.get('is_current')?.value"
                               [attr.disabled]="edu.get('is_current')?.value"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                               [ngClass]="{'bg-gray-100': edu.get('is_current')?.value}">
                      </div>
                    </div>
                  </div>
          
                  <!-- Description -->
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea formControlName="description"
                             rows="3"
                             class="block w-full px-4 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </textarea>
                  </div>
                </div>
              </div>
            </div>
          </section>
      
          <!-- Skills Section -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center justify-between border-b pb-4">
              <div class="flex items-center gap-4">
                <i class="fas fa-tools text-lg text-blue-600"></i>
                <h2 class="text-xl font-medium" *ngIf="!isEditingSkillsTitle">{{ f['skills_title'].value || 'SKILLS' }}</h2>
                <input type="text"
                       *ngIf="isEditingSkillsTitle"
                       formControlName="skills_title"
                       class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                       (blur)="toggleTitleEdit('skills')"
                       (keyup.enter)="toggleTitleEdit('skills')"
                       [value]="f['skills_title'].value">
                <button type="button" 
                        (click)="toggleTitleEdit('skills')"
                        class="text-gray-400 hover:text-blue-600 ml-2">
                  <i class="fas" [class.fa-edit]="!isEditingSkillsTitle" [class.fa-check]="isEditingSkillsTitle"></i>
                </button>
              </div>
              <button type="button" 
                      (click)="addSkill()"
                      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                <i class="fas fa-plus"></i>
                Add Skill
              </button>
            </div>
  
            <div formArrayName="skills">
              <div *ngFor="let skill of skillsArray.controls; let i = index"
                   [formGroupName]="i"
                   class="bg-white rounded-lg shadow-sm p-6 relative">
                <!-- Remove Button -->
                <button type="button"
                        (click)="removeSkill(i)"
                        class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                  <i class="fas fa-trash-alt"></i>
                </button>
  
                <!-- Skill Form Fields -->
                <div class="grid md:grid-cols-2 gap-6">
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Skill Name</label>
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-star text-gray-400"></i>
                      </div>
                      <input type="text"
                             formControlName="skill"
                             class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                  </div>
  
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Proficiency</label>
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-chart-bar text-gray-400"></i>
                      </div>
                      <select formControlName="proficiency"
                              class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">Select Proficiency</option>
                        <option value="Beginner">Beginner</option>
                        <option value="Intermediate">Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Expert">Expert</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
  
          <!-- Projects Section -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center justify-between border-b pb-4">
              <div class="flex items-center gap-4">
                <i class="fas fa-project-diagram text-lg text-blue-600"></i>
                <h2 class="text-xl font-medium" *ngIf="!isEditingProjectsTitle">{{ f['projects_title'].value || 'PROJECTS' }}</h2>
                <input type="text"
                       *ngIf="isEditingProjectsTitle"
                       formControlName="projects_title"
                       class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                       (blur)="toggleTitleEdit('projects')"
                       (keyup.enter)="toggleTitleEdit('projects')"
                       [value]="f['projects_title'].value">
                <button type="button" 
                        (click)="toggleTitleEdit('projects')"
                        class="text-gray-400 hover:text-blue-600 ml-2">
                  <i class="fas" [class.fa-edit]="!isEditingProjectsTitle" [class.fa-check]="isEditingProjectsTitle"></i>
                </button>
              </div>
              <button type="button" 
                      (click)="addProject()"
                      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                <i class="fas fa-plus"></i>
                Add Project
              </button>
            </div>
  
            <div formArrayName="projects">
              <div *ngFor="let project of projectsArray.controls; let i = index"
                   [formGroupName]="i"
                   class="bg-white rounded-lg shadow-sm p-6 relative">
                <!-- Remove Button -->
                <button type="button"
                        (click)="removeProject(i)"
                        class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                  <i class="fas fa-trash-alt"></i>
                </button>
  
                <!-- Project Form Fields -->
                <div class="grid gap-6">
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Project Name</label>
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-folder text-gray-400"></i>
                      </div>
                      <input type="text"
                             formControlName="name"
                             class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                  </div>
  
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea formControlName="description"
                             rows="3"
                             class="block w-full px-4 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </textarea>
                  </div>
  
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Project Link (Optional)</label>
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-link text-gray-400"></i>
                      </div>
                      <input type="url"
                             formControlName="link"
                             class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
  
          <!-- Certifications Section -->
          <section class="space-y-6 bg-gray-50 rounded-lg p-6">
            <div class="flex items-center justify-between border-b pb-4">
              <div class="flex items-center gap-4">
                <i class="fas fa-certificate text-lg text-blue-600"></i>
                <h2 class="text-xl font-medium" *ngIf="!isEditingCertificationsTitle">{{ f['certifications_title'].value || 'CERTIFICATIONS' }}</h2>
                <input type="text"
                       *ngIf="isEditingCertificationsTitle"
                       formControlName="certifications_title"
                       class="text-xl font-medium bg-transparent border-b border-gray-300 focus:border-blue-500 focus:outline-none px-1"
                       (blur)="toggleTitleEdit('certifications')"
                       (keyup.enter)="toggleTitleEdit('certifications')"
                       [value]="f['certifications_title'].value">
                <button type="button" 
                        (click)="toggleTitleEdit('certifications')"
                        class="text-gray-400 hover:text-blue-600 ml-2">
                  <i class="fas" [class.fa-edit]="!isEditingCertificationsTitle" [class.fa-check]="isEditingCertificationsTitle"></i>
                </button>
              </div>
              <button type="button" 
                      (click)="addCertification()"
                      class="inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700">
                <i class="fas fa-plus"></i>
                Add Certification
              </button>
            </div>
  
            <div formArrayName="certifications">
              <div *ngFor="let cert of certificationsArray.controls; let i = index"
                   [formGroupName]="i"
                   class="bg-white rounded-lg shadow-sm p-6 relative">
                <!-- Remove Button -->
                <button type="button"
                        (click)="removeCertification(i)"
                        class="absolute top-4 right-4 text-gray-400 hover:text-red-500">
                  <i class="fas fa-trash-alt"></i>
                </button>
  
                <!-- Certification Form Fields -->
                <div class="grid gap-6">
                  <div class="grid md:grid-cols-2 gap-6">
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Certification Name</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-award text-gray-400"></i>
                        </div>
                        <input type="text"
                               formControlName="title"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
  
                    <div class="form-group">
                      <label class="block text-sm font-medium text-gray-700 mb-2">Issuing Organization</label>
                      <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <i class="fas fa-building text-gray-400"></i>
                        </div>
                        <input type="text"
                               formControlName="issuer"
                               class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                      </div>
                    </div>
                  </div>
  
                  <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Date Received</label>
                    <div class="relative">
                      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-calendar-check text-gray-400"></i>
                      </div>
                      <input type="date"
                             formControlName="date"
                             class="block w-full pl-10 py-3 text-gray-700 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
  
          <!-- Form Actions -->
          <div class="flex justify-between items-center gap-4 pt-6 border-t">
           
              <button type="button"
                      (click)="onCancel()"
                      class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center gap-2">
                <i class="fas fa-times"></i>
                Cancel
              </button>
              <button type="submit"
                      [disabled]="loading"
                      class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas" [class.fa-save]="!loading" [class.fa-spinner]="loading" [class.fa-spin]="loading"></i>
                {{ loading ? 'Saving...' : 'Save Resume' }}
              </button>
            
          </div>
        </form>
      </div>
    </div>
  </div>